//	FILE:		LoopPage.ci
//
//
//	DESCRIPTION:	This file contains various functions for the loop page
//
// 	---------------------		Attach Comment Functions 	------------------------
//


//	FUNCTION:	LoopPage_RightClick
//
//	DESCRIPTION:	Right click menu on loop page equipment tree only for loops equipment
//
INT
FUNCTION LoopPage_RightClick(INT hNode, STRING sEquipPath)
	IF hNode > -1 THEN
		Prompt(sEquipPath);
		SELECT CASE sEquipPath
		CASE "Loops.Level"
			RETURN LoopPage_RightClickMenu(530);
		CASE "Loops.Density"
			RETURN LoopPage_RightClickMenu(525);
		CASE "Loops.Temperature"
			RETURN LoopPage_RightClickMenu(521);
		END SELECT
		Prompt(sEquipPath + " @(has no popup menu.)");
	END
	RETURN 274;	// invalid argument
END

//	FUNCTION:	LoopPage_RightClick
//
//	DESCRIPTION:	Right click menu on loop page equipment tree
//
INT FUNCTION LoopPage_RightClickMenu(INT hAN)
	INT iSelection;
	STRING sMeta;

	DspPopupMenu(0, "PID Loop,Sequence of Events,Display Trends");
	iSelection = DspPopupMenu(-1, "");
	SELECT CASE iSelection
	CASE 1
		AssMetadataPopUp("!PID",hAN);
	CASE 2
		sMeta = DspAnGetMetadata(hAN, "PID_Equip");
		sMeta = StrRight(sMeta,StrLength(sMeta)-1);
		SOE_PopUp(sMeta);
	CASE 3
		sMeta = DspAnGetMetadata(hAN, "PID_PAV");
		sMeta = StrRight(sMeta,StrLength(sMeta)-1);
		ProcessAnalystPopup("!ProcessAnalystPopup",sMeta);
	END SELECT
	RETURN 0;
END



